<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>K-Stone | ì „ì„¤ì˜ ì„ ìˆ ì§‘</title>
    <style>
        :root {
            --mana: #3b82f6;
            --hp: #ef4444;
            --atk: #f59e0b;
            --legendary: #fbbf24;
            --epic: #a855f7;
            --rare: #3b82f6;
            --common: #94a3b8;
        }
        body, html { margin: 0; padding: 0; height: 100%; background: #0f172a; font-family: 'Pretendard', sans-serif; overflow: hidden; color: white; }
        
        #game-board {
            display: flex; flex-direction: column; height: 100vh; max-width: 600px; margin: 0 auto;
            background: radial-gradient(circle, #2d1b14 0%, #1a0f0a 100%);
            border: 4px solid #3d2b1f; position: relative;
        }

        /* ë“±ê¸‰ë³„ íš¨ê³¼ */
        .rarity-legendary { border-color: var(--legendary) !important; box-shadow: 0 0 15px var(--legendary); animation: gold-glow 2s infinite; }
        @keyframes gold-glow { 0% { box-shadow: 0 0 5px var(--legendary); } 50% { box-shadow: 0 0 20px var(--legendary); } 100% { box-shadow: 0 0 5px var(--legendary); } }
        .rarity-epic { border-color: var(--epic) !important; }
        .rarity-rare { border-color: var(--rare) !important; }

        /* í•„ë“œ ë° ì˜ì›… */
        .hero-area { display: flex; justify-content: center; align-items: center; padding: 10px; gap: 15px; height: 90px; }
        .hero-portrait { width: 60px; height: 80px; background: #334155; border: 3px solid #94a3b8; border-radius: 50% 50% 10% 10%; position: relative; display: flex; justify-content: center; align-items: center; font-size: 30px; }
        .hero-hp { position: absolute; bottom: -5px; right: -5px; background: var(--hp); border-radius: 50%; width: 22px; height: 22px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px; border: 2px solid white; }
        .hero-power { width: 45px; height: 45px; border-radius: 50%; background: #1e293b; border: 2px solid #daa520; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; }

        #field { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; gap: 10px; }
        .minion-row { display: flex; justify-content: center; gap: 6px; height: 100px; align-items: center; }

        /* í•˜ìˆ˜ì¸ */
        .minion { width: 65px; height: 85px; background: #1e293b; border: 2px solid #475569; border-radius: 8px; position: relative; display: flex; flex-direction: column; justify-content: flex-end; transition: transform 0.2s; }
        .minion.taunt { border-width: 4px; border-style: double; }
        .minion .cost { position: absolute; top: -6px; left: -6px; background: var(--mana); border-radius: 50%; width: 18px; height: 18px; font-size: 11px; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 1px solid white; }
        .minion .stats { display: flex; justify-content: space-between; padding: 2px 4px; font-weight: 900; font-size: 12px; }
        .minion .atk { color: var(--atk); }
        .minion .hp { color: var(--hp); }
        .minion .emoji { font-size: 28px; text-align: center; position: absolute; top: 15px; width: 100%; }

        /* í•¸ë“œ */
        #hand { height: 110px; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: flex-start; padding-top: 10px; }
        #hand .minion { cursor: pointer; margin: 0 -8px; box-shadow: 0 5px 10px black; }
        #hand .minion:hover { transform: translateY(-25px) scale(1.3); z-index: 100; }

        /* í„´ ë²„íŠ¼ */
        #end-turn-btn { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: #fbbf24; color: #451a03; border: 2px solid #451a03; padding: 8px 12px; font-weight: 900; cursor: pointer; border-radius: 4px; font-size: 12px; box-shadow: 0 3px 0 #92400e; }
        #end-turn-btn:active { transform: translateY(-50%) translateY(2px); box-shadow: 0 1px 0 #92400e; }

        /* ì´í™íŠ¸ */
        #fx-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1000; }
        .legend-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 50px; font-weight: 900; color: var(--legendary); text-shadow: 0 0 20px orange; animation: splash 1.5s forwards; }
        @keyframes splash { 0% { scale: 0.5; opacity: 0; } 50% { scale: 1.2; opacity: 1; } 100% { scale: 1; opacity: 0; } }
        
        .mana-area { display: flex; justify-content: flex-end; padding: 5px 15px; gap: 3px; }
        .mana-gem { width: 10px; height: 10px; background: var(--mana); transform: rotate(45deg); border: 1px solid white; }
        .mana-gem.empty { background: #1e293b; border-color: #334155; }
    </style>
</head>
<body>
    <div id="game-board">
        <div class="hero-area">
            <div class="hero-portrait" style="border-color: var(--hp);">ğŸ‘¿<div class="hero-hp" id="enemy-hp">30</div></div>
            <div class="hero-power">ğŸ”¥</div>
        </div>

        <div id="field">
            <div class="minion-row" id="enemy-minions"></div>
            <div id="end-turn-btn" onclick="endTurn()">í„´ ì¢…ë£Œ</div>
            <div class="minion-row" id="player-minions"></div>
        </div>

        <div class="mana-area" id="mana-bar"></div>

        <div class="hero-area">
            <div class="hero-portrait" style="border-color: var(--mana);">ğŸ§™<div class="hero-hp" id="player-hp">30</div></div>
            <div class="hero-power" onclick="useHeroPower()">âœ¨</div>
        </div>

        <div id="hand"></div>
        <div id="fx-layer"></div>
    </div>

    <script>
        const CARDS = [
            { name: "ê³¨ë“œì…” ë³´ë³‘", cost: 1, atk: 1, hp: 2, emoji: "ğŸ›¡ï¸", taunt: true, rarity: 'common' },
            { name: "ë¯¼ë¬¼ì•…ì–´", cost: 2, atk: 2, hp: 3, emoji: "ğŸŠ", rarity: 'common' },
            { name: "í‘¸ë¥¸ìƒ‰ ìš©", cost: 4, atk: 4, hp: 4, emoji: "ğŸ‰", rarity: 'rare', battlecry: 'draw' },
            { name: "ì„¼ì§„ ë°©íŒ¨ëŒ€ê°€", cost: 4, atk: 3, hp: 5, emoji: "ğŸ‘¹", taunt: true, rarity: 'rare' },
            { name: "ê³µì„± ì „ì°¨", cost: 5, atk: 5, hp: 7, emoji: "ğŸšœ", rarity: 'epic' },
            { name: "ë¦¬ì¹˜ ì™•", cost: 8, atk: 8, hp: 8, emoji: "ğŸ’€", taunt: true, rarity: 'legendary' },
            { name: "ë¼ê·¸ë‚˜ë¡œìŠ¤", cost: 8, atk: 8, hp: 8, emoji: "ğŸ”¥", rarity: 'legendary' }
        ];

        let state = {
            player: { hp: 30, mana: 1, maxMana: 1, hand: [], field: [] },
            enemy: { hp: 30, mana: 1, maxMana: 1, field: [] },
            turn: 'player'
        };

        function init() {
            for(let i=0; i<3; i++) drawCard(state.player);
            render();
        }

        function drawCard(p) {
            if(p.hand.length < 10) {
                const c = CARDS[Math.floor(Math.random()*CARDS.length)];
                p.hand.push({ ...c, id: Math.random(), curAtk: c.atk, curHp: c.hp });
            }
        }

        function playCard(card) {
            if(state.turn !== 'player' || state.player.mana < card.cost || state.player.field.length >= 7) return;
            state.player.mana -= card.cost;
            state.player.hand = state.player.hand.filter(c => c.id !== card.id);
            state.player.field.push(card);
            
            if(card.rarity === 'legendary') playLegendEffect();
            if(card.battlecry === 'draw') drawCard(state.player);
            render();
        }

        function playLegendEffect() {
            const fx = document.getElementById('fx-layer');
            const txt = document.createElement('div');
            txt.className = 'legend-text';
            txt.innerText = 'LEGENDARY!';
            fx.appendChild(txt);
            document.body.style.animation = 'shake 0.5s';
            setTimeout(() => { txt.remove(); document.body.style.animation = ''; }, 1500);
        }

        function useHeroPower() {
            if(state.turn !== 'player' || state.player.mana < 2) return;
            state.player.mana -= 2;
            state.enemy.hp -= 1;
            render();
        }

        async function endTurn() {
            if(state.turn !== 'player') return;
            state.turn = 'enemy';
            
            // ë‹¨ìˆœ ì „íˆ¬ ë¡œì§
            for(let m of state.player.field) {
                const target = state.enemy.field.find(e => e.taunt) || state.enemy.field[0];
                if(target) { target.curHp -= m.curAtk; m.curHp -= target.curAtk; }
                else { state.enemy.hp -= m.curAtk; }
                state.player.field = state.player.field.filter(x => x.curHp > 0);
                state.enemy.field = state.enemy.field.filter(x => x.curHp > 0);
                render(); await new Promise(r => setTimeout(r, 400));
            }

            // AI í„´
            let em = state.enemy.maxMana;
            while(em > 0 && state.enemy.field.length < 7) {
                const c = CARDS.filter(x => x.cost <= em)[0];
                if(!c) break;
                state.enemy.field.push({ ...c, id: Math.random(), curAtk: c.atk, curHp: c.hp });
                em -= c.cost;
            }
            state.enemy.maxMana = Math.min(state.enemy.maxMana + 1, 10);

            state.player.maxMana = Math.min(state.player.maxMana + 1, 10);
            state.player.mana = state.player.maxMana;
            drawCard(state.player);
            state.turn = 'player';
            render();
        }

        function render() {
            document.getElementById('player-hp').innerText = state.player.hp;
            document.getElementById('enemy-hp').innerText = state.enemy.hp;
            
            const mb = document.getElementById('mana-bar'); mb.innerHTML = '';
            for(let i=0; i<state.player.maxMana; i++) {
                const gem = document.createElement('div');
                gem.className = 'mana-gem' + (i >= state.player.mana ? ' empty' : '');
                mb.appendChild(gem);
            }

            const handEl = document.getElementById('hand'); handEl.innerHTML = '';
            state.player.hand.forEach(c => {
                const el = createMinionEl(c);
                el.onclick = () => playCard(c);
                handEl.appendChild(el);
            });

            document.getElementById('player-minions').innerHTML = '';
            state.player.field.forEach(c => document.getElementById('player-minions').appendChild(createMinionEl(c)));
            document.getElementById('enemy-minions').innerHTML = '';
            state.enemy.field.forEach(c => document.getElementById('enemy-minions').appendChild(createMinionEl(c)));
        }

        function createMinionEl(c) {
            const div = document.createElement('div');
            div.className = `minion rarity-${c.rarity} ${c.taunt ? 'taunt' : ''}`;
            div.innerHTML = `<div class="cost">${c.cost}</div><div class="emoji">${c.emoji}</div><div class="stats"><span class="atk">${c.curAtk}</span><span class="hp">${c.curHp}</span></div>`;
            return div;
        }

        init();
    </script>
    <style> @keyframes shake { 0%, 100% { transform: translate(0, 0); } 25% { transform: translate(-5px, 5px); } 50% { transform: translate(5px, -5px); } 75% { transform: translate(-5px, -5px); } } </style>
</body>
</html>
